@using K9.Base.WebApplication.Helpers
@using Dictionary = K9.Base.Globalisation.Dictionary
@model UserAccount.RegisterModel

@{
    ViewBag.Title = K9.Base.Globalisation.Dictionary.Registration;
    ViewBag.SubTitle = K9.Base.Globalisation.Dictionary.Register;
    Layout = "../Shared/_LayoutFormSmall.cshtml";
}

@using (Html.BeginForm())
{
    using (Html.BeginBootstrapForm())
    {
        @Html.BootstrapEditorFor(model => model.UserName)
        @Html.BootstrapEditorFor(model => model.Password)
        @Html.BootstrapEditorFor(model => model.ConfirmPassword)

        <hr />
        <div>
            <div class="col-sm-6">@Html.BootstrapEditorFor(model => model.FirstName)</div>
            <div class="col-sm-6">@Html.BootstrapEditorFor(model => model.LastName)</div>
        </div>
        @Html.BootstrapEditorFor(model => model.EmailAddress)
        <div>
            <div class="col-sm-6">@Html.BootstrapEditorFor(model => model.BirthDate)</div>
            <div class="col-sm-6">@Html.BootstrapEditorFor(model => model.Gender)</div>
        </div>
        @Html.BootstrapEditorFor(model => model.PhoneNumber)
        <hr />
        @Html.BootstrapButton(K9.Base.Globalisation.Dictionary.Register)
        @Html.BootstrapActionLinkButton(Dictionary.SignInWithFacebook, "Facebook", "Account", null, "fa-facebook")
    }
}

<script language="javascript">

    $("#UserName").change(function() {
        var username = $(this).val();
        ajaxcontroller().get("@Url.Action("IsUserNameAvailable")", { username }).done(
            function(result) {
                if (result.success && result.data) {
                    $.fn.displayValidationWarningFor("UserName", "@K9.Base.Globalisation.Dictionary.UsernameIsUnavailableError");
                } else {
                    $.fn.hideValidationWarningFor("UserName");
                }
            });
    });

    $("#EmailAddress").change(function() {
        var emailAddress = $(this).val();
        ajaxcontroller().get("@Url.Action("IsEmailAddressAvailable")", { emailAddress }).done(
            function(result) {
                if (result.success && result.data) {
                    $.fn.displayValidationWarningFor("EmailAddress", "@K9.Base.Globalisation.Dictionary.EmailIsUnavailableError");
                } else {
                    $.fn.hideValidationWarningFor("EmailAddress");
                }
            });
    });

</script>